local repo = "https://raw.githubusercontent.com/deividcomsono/Obsidian/main/"
local Library = loadstring(game:HttpGet(repo .. "Library.lua"))()

local Toggles = Library.Toggles

local Window = Library:CreateWindow({
    Title = "Radiology Autofarm",
    Footer = "by MasterZ",
    Icon = 0,
    NotifySide = "Right",
    ShowCustomCursor = true,
})

local Tabs = {
    Main = Window:AddTab("Main", "toggle-left"),
}

local GroupBox = Tabs.Main:AddLeftGroupbox("Autofarm")

GroupBox:AddToggle("RadiologyToggle", {
    Text = "Autofarm Radiology (Sekali Jalan)",
    Default = false,
    Tooltip = "Jalankan urutan sekali tanpa looping",
    Callback = function(value)
        if value then
            task.spawn(function()
                local TweenService = game:GetService("TweenService")
                local Players = game:GetService("Players")
                local player = Players.LocalPlayer
                local char = player.Character or player.CharacterAdded:Wait()
                local hrp = char:WaitForChild("HumanoidRootPart")

                local function tweenTo(part)
                    if part and part:IsA("BasePart") then
                        local goal = { CFrame = part.CFrame + Vector3.new(0, 3, 0) }
                        local tween = TweenService:Create(hrp, TweenInfo.new(1, Enum.EasingStyle.Linear), goal)
                        tween:Play()
                        tween.Completed:Wait()
                    end
                end

                local room = workspace:WaitForChild("RadiologyRooms"):FindFirstChild("RadiologyRoom1")
                if not room then warn("❌ RadiologyRoom1 tidak ditemukan.") return end

                -- Step 1: Wedgera
                tweenTo(room:FindFirstChild("Wedgera", true))

                -- Step 2: Trigger ClickDetector
                local clickPart
                local machine = room:FindFirstChild("X-Ray (with CXR and table) Machine", true)
                if machine then
                    local xray = machine:FindFirstChild("X-Ray Machine")
                    if xray then
                        for _, p in ipairs(xray:GetDescendants()) do
                            if p:IsA("ClickDetector") then
                                clickPart = p.Parent
                                break
                            end
                        end
                    end
                end

                local xrayBtnPrompt
                local xrayBtn = room:FindFirstChild("X-Ray Button")
                if xrayBtn then
                    for _, part in ipairs(xrayBtn:GetChildren()) do
                        local p = part:FindFirstChildWhichIsA("ProximityPrompt")
                        if p then xrayBtnPrompt = p break end
                    end
                end

                while xrayBtnPrompt and not xrayBtnPrompt.Enabled do
                    if clickPart then
                        local cd = clickPart:FindFirstChildWhichIsA("ClickDetector")
                        if cd then fireclickdetector(cd) end
                    end
                    task.wait(0.5)
                end

                -- Step 3: radiologycomputer2
                local computer = room:FindFirstChild("radiologycomputer2")
                if computer then
                    tweenTo(computer)
                    local p = computer:FindFirstChildWhichIsA("ProximityPrompt", true)
                    if p then fireproximityprompt(p) end
                end

                -- Step 4: Attachment
                for _, part in ipairs(room:GetDescendants()) do
                    if part:IsA("Attachment") and part:FindFirstChildWhichIsA("ProximityPrompt") then
                        local parent = part.Parent
                        if parent:IsA("BasePart") then
                            tweenTo(parent)
                            fireproximityprompt(part:FindFirstChildWhichIsA("ProximityPrompt"))
                            break
                        end
                    end
                end

                -- Step 5: Equip Tool Wedge
                local wedge = player.Backpack:FindFirstChild("Wedge")
                if wedge then player.Character:FindFirstChildOfClass("Humanoid"):EquipTool(wedge) end

                -- Step 6: Torso
                local torso = room:FindFirstChild("PatientRadiology", true)
                torso = torso and torso:FindFirstChild("Torso")
                if torso then
                    tweenTo(torso)
                    local p = torso:FindFirstChildWhichIsA("ProximityPrompt")
                    if p then fireproximityprompt(p) end
                end

                -- Step 7: dd
                local dd = machine and machine:FindFirstChild("X-Ray Table")
                dd = dd and dd:FindFirstChild("Table")
                dd = dd and dd:FindFirstChild("dd")
                if dd then
                    tweenTo(dd)
                    local p = dd:FindFirstChildWhichIsA("ProximityPrompt")
                    if p then fireproximityprompt(p) end
                end

                -- Step 8: ProximityPrompt di X-Ray Button
                if xrayBtn then
                    for _, part in ipairs(xrayBtn:GetChildren()) do
                        local p = part:FindFirstChildWhichIsA("ProximityPrompt")
                        if p then
                            tweenTo(part)
                            fireproximityprompt(p)
                            break
                        end
                    end
                end

                task.wait(4)

                -- Step 9: radiologycomputer2 lagi
                if computer then
                    tweenTo(computer)
                    local p = computer:FindFirstChildWhichIsA("ProximityPrompt", true)
                    if p then fireproximityprompt(p) end
                end

                -- Step 10: Torso lagi
                if torso then
                    tweenTo(torso)
                    local p = torso:FindFirstChildWhichIsA("ProximityPrompt")
                    if p then fireproximityprompt(p) end
                end

                -- Step 11: Sheet
                local sheet = machine and machine:FindFirstChild("X-Ray Table")
                sheet = sheet and sheet:FindFirstChild("Table")
                sheet = sheet and sheet:FindFirstChild("Sheet")
                if sheet then
                    tweenTo(sheet)
                    local p = sheet:FindFirstChildWhichIsA("ProximityPrompt")
                    if p then fireproximityprompt(p) end
                end

                -- Step 12: krim2
                local krim2 = room:FindFirstChild("Closet", true)
                krim2 = krim2 and krim2:FindFirstChild("krim2")
                local att = krim2 and krim2:FindFirstChildWhichIsA("Attachment")
                if att then
                    local p = att:FindFirstChildWhichIsA("ProximityPrompt")
                    if p then
                        tweenTo(krim2)
                        fireproximityprompt(p)
                    end
                end

                -- Step 13: Balik lagi ke Sheet
                if sheet then
                    tweenTo(sheet)
                    local p = sheet:FindFirstChildWhichIsA("ProximityPrompt")
                    if p then fireproximityprompt(p) end
                end

                -- Step 14: Torso terakhir
                if torso then
                    tweenTo(torso)
                    local p = torso:FindFirstChildWhichIsA("ProximityPrompt")
                    if p then fireproximityprompt(p) end
                end

                print("✅ Semua langkah Radiology selesai dijalankan.")
            end)
        end
    end
})
