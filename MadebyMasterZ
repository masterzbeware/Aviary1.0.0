-- Ganti nama client sesuai nama pemain asli
local ClientName = "akunoctora"

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

local localPlayer = Players.LocalPlayer
local client = nil
local follow = false

local humanoid
local hrp

-- Setup karakter bot
local function setupCharacter()
	local character = localPlayer.Character or localPlayer.CharacterAdded:Wait()
	humanoid = character:WaitForChild("Humanoid")
	hrp = character:WaitForChild("HumanoidRootPart")
end

-- Fungsi untuk membuat bot berjalan ke posisi target
local function walkTo(position)
	if humanoid then
		humanoid:MoveTo(position)
	end
end

-- Fungsi utama: mengikuti client sejajar dari belakang
local function followClient()
	if not client or not client.Character or not humanoid or not hrp then return end

	local clientHRP = client.Character:FindFirstChild("HumanoidRootPart")
	if not clientHRP then return end

	-- Posisi target: 5 studs di belakang client
	local targetPos = clientHRP.Position - clientHRP.CFrame.LookVector * 5

	local distance = (hrp.Position - targetPos).Magnitude

	if distance > 6 then
		-- Terlalu jauh dari posisi ideal, mulai jalan
		walkTo(targetPos)
	elseif distance < 3 then
		-- Terlalu dekat, perbaiki posisi mundur sedikit
		local adjustPos = hrp.Position - hrp.CFrame.LookVector * 2
		humanoid:MoveTo(adjustPos)
	else
		-- Sudah ideal, diam
		humanoid:MoveTo(hrp.Position)
	end
end

-- Dengarkan chat client
local function setupClientChat(player)
	if player.Name == ClientName then
		client = player
		print("[DEBUG] Client ditemukan: " .. player.Name)

		player.Chatted:Connect(function(msg)
			if msg == "!ikuti" then
				follow = true
				print("[DEBUG] Perintah !ikuti diterima")
			elseif msg == "!stop" then
				follow = false
				humanoid:MoveTo(hrp.Position)
				print("[DEBUG] Perintah !stop diterima")
			end
		end)
	end
end

-- Saat pemain join
Players.PlayerAdded:Connect(setupClientChat)

-- Cek pemain yang sudah ada dulu
for _, p in pairs(Players:GetPlayers()) do
	setupClientChat(p)
end

-- Saat karakter bot spawn
localPlayer.CharacterAdded:Connect(setupCharacter)
setupCharacter()

-- Loop utama
while true do
	task.wait(0.5)
	if follow then
		followClient()
	end
end
