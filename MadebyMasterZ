local repo = "https://raw.githubusercontent.com/deividcomsono/Obsidian/main/"
local Library = loadstring(game:HttpGet(repo .. "Library.lua"))()

local Toggles = Library.Toggles

local Window = Library:CreateWindow({
    Title = "Radiology Autofarm",
    Footer = "by MasterZ",
    Icon = 0,
    NotifySide = "Right",
    ShowCustomCursor = true,
})

local Tabs = {
    Main = Window:AddTab("Main", "toggle-left"),
}

local GroupBox = Tabs.Main:AddLeftGroupbox("Autofarm")

local autofarmRadiology = false

GroupBox:AddToggle("RadiologyToggle", {
    Text = "Autofarm RadiologyRoom1",
    Default = false,
    Callback = function(value)
        autofarmRadiology = value
        if value then
            task.spawn(function()
                local TweenService = game:GetService("TweenService")
                local Players = game:GetService("Players")
                local player = Players.LocalPlayer
                local char = player.Character or player.CharacterAdded:Wait()
                local hrp = char:WaitForChild("HumanoidRootPart")

                local function tweenTo(part)
                    if not part then return end
                    local goal = { CFrame = part.CFrame + Vector3.new(0, 3, 0) }
                    local tween = TweenService:Create(hrp, TweenInfo.new(1, Enum.EasingStyle.Linear), goal)
                    tween:Play()
                    tween.Completed:Wait()
                end

                -- Ambil RadiologyRoom1 pertama
                local room
                for _, r in ipairs(workspace:WaitForChild("RadiologyRooms"):GetChildren()) do
                    if r:IsA("Model") and r.Name == "RadiologyRoom1" then
                        room = r
                        break
                    end
                end

                if not room then warn("Room tidak ditemukan") return end

                -- Cari ClickDetector
                local clickPart
                local machine = room:FindFirstChild("X-Ray (with CXR and table) Machine", true)
                if machine then
                    local sub = machine:FindFirstChild("X-Ray Machine")
                    if sub then
                        for _, obj in ipairs(sub:GetDescendants()) do
                            if obj:IsA("ClickDetector") then
                                clickPart = obj.Parent
                                break
                            end
                        end
                    end
                end

                if not clickPart then warn("ClickDetector tidak ditemukan") return end

                -- Tween ke Part & trigger
                tweenTo(clickPart)
                for i = 1, 5 do
                    if not autofarmRadiology then return end
                    pcall(function()
                        fireclickdetector(clickPart:FindFirstChildWhichIsA("ClickDetector"))
                    end)
                    wait(0.5)
                end

                -- Tunggu ProximityPrompt aktif
                local prompt
                local xrayBtn = room:FindFirstChild("X-Ray Button")
                if xrayBtn then
                    for _, part in ipairs(xrayBtn:GetChildren()) do
                        local p = part:FindFirstChildWhichIsA("ProximityPrompt")
                        if p then
                            prompt = p
                            break
                        end
                    end
                end

                if not prompt then warn("Prompt tidak ditemukan") return end

                repeat
                    if not autofarmRadiology then return end
                    print("Menunggu prompt aktif...")
                    wait(0.5)
                until prompt.Enabled

                print("âœ… Prompt aktif!")
            end)
        end
    end
})
